# HG changeset patch
# User Andreas Obergschwandtner <andreas.obergschwandtner@skidata.com>
# Date 1537519446 -7200
#      Fri Sep 21 10:44:06 2018 +0200
# Node ID 213da2c3ee54a558abd30b0230afa40d4b4e7f83
# Parent  80ee2541504ec08d65da9d968a18a00a69858ce0
Handle format error for GCC >= 7

diff --git a/hotspot/src/share/vm/adlc/output_c.cpp b/hotspot/src/share/vm/adlc/output_c.cpp
--- a/hotspot/src/share/vm/adlc/output_c.cpp
+++ b/hotspot/src/share/vm/adlc/output_c.cpp
@@ -436,9 +436,11 @@
   for (i = maxcycleused; i > 0; i /= 10)
     cycledigit++;
 
-  int maskdigit = 0;
-  for (i = rescount; i > 0; i /= 10)
+  int maskdigit = 1;
+  for (i = rescount / 10; i > 0; i /= 10)
     maskdigit++;
+  if (maskdigit > 10)
+    maskdigit = 10;
 
   static const char* pipeline_use_cycle_mask = "Pipeline_Use_Cycle_Mask";
   static const char* pipeline_use_element    = "Pipeline_Use_Element";
diff --git openjdk/hotspot/src/share/vm/adlc/dfa.cpp openjdk/hotspot/src/share/vm/adlc/dfa.cpp
index af18bee1..075e7c49 100644
--- openjdk/hotspot/src/share/vm/adlc/dfa.cpp
+++ openjdk/hotspot/src/share/vm/adlc/dfa.cpp
@@ -25,6 +25,12 @@
 // DFA.CPP - Method definitions for outputting the matcher DFA from ADLC
 #include "adlc.hpp"

+// disable format overflow checking for GCC versions
+// See https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html
+#if defined (__GNUC__) && __GNUC__ >= 7
+#pragma GCC diagnostic ignored "-Wstringop-overflow"
+#endif
+
 //---------------------------Switches for debugging output---------------------
 static bool debug_output   = false;
 static bool debug_output1  = false;    // top level chain rules
